import { Meta, Title, Subtitle, Description, Controls, Primary, Stories, Markdown, Unstyled } from '@storybook/addon-docs/blocks';
import * as HeadStories from './index.stories';
import '../../css/style.css';
export const Check = () => <svg 
    viewBox="0 0 24 24" 
    width="20px" 
    height="20px" 
    style={{ 
      inset: '4px auto 0 -28px',
      background: '#fff',
      position: 'absolute',
      display: 'inline-block',
      shapeRendering: 'inherit',
      verticalAlign: 'middle',
      fill: 'none',
      stroke : 'var(--Main-Color-Base)',
      strokeWidth: '3',
      strokeLinecap:'round',
      strokeLinejoin:'round',
      Zindex: '2'
    }}
><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><path d="m9 11 3 3L22 4"></path></svg>

<Meta of={HeadStories} name="コード"/>
<Title />
<Subtitle of={HeadStories} />
<Description of={HeadStories} />
<Unstyled>
<main className="document">
  <div className="sb_section">
    ### アクセシビリティチェック項目
    * <Check /> <a href="https://www.w3.org/WAI/ARIA/apg/" target="_blank">APG</a>を参考に適切な役割、ステート、プロパティの値を設定する
    * <Check />キーボード操作でもマウスと変わりなく操作できる
  </div>
</main>
</Unstyled>

<Primary />


### Javascript
```javascript

// 起動
document.addEventListener("DOMContentLoaded", () => {
  document.querySelectorAll(".js_accordion").forEach((el) => {
    const acc = new Accordion(el);
    acc.init();
  });
});

// アコーディオンのClass
class Accordion {
  constructor(el) {
    this.details = el;
    this.trigger = el.querySelector("summary");
    this.panel = this.trigger.nextElementSibling;
    this.isOpen = el.open;
    this.isAnimating = false;
  }

  // 初期化
  init() {
    this._updateAria(this.isOpen);
    this.trigger.setAttribute("role", "button");

    this.panel.style.overflow = "hidden";
    this.panel.style.height = this.isOpen ? "auto" : "0";

    this.trigger.addEventListener("click", (e) => {
      e.preventDefault();
      this.toggle();
    });

    this.trigger.addEventListener("keydown", (e) => {
      if (e.key === "Enter" || e.key === " ") {
        e.preventDefault();
        this.toggle();
      }
    });
  }

  async toggle() {
    if (this.isAnimating) return;

    this.isOpen = !this.isOpen;
    this.details.open = true; // open属性を先に立てる

    this._updateAria(this.isOpen);
    this.isAnimating = true;

    if (this.isOpen) {
      await this._expand();
    } else {
      await this._collapse();
      this.details.open = false; // 閉じた後にopenをfalse
    }

    this.isAnimating = false;
  }

  _updateAria(isOpen) {
    this.trigger.setAttribute("aria-expanded", String(isOpen));
    this.panel.setAttribute("aria-hidden", String(!isOpen));
  }

  _expand() {
    this.panel.style.height = "auto";
    const height = this.panel.scrollHeight + "px";
    this.panel.style.height = "0";
    requestAnimationFrame(() => {
      this.panel.style.transition = "height 300ms ease-in-out";
      this.panel.style.height = height;
    });

    return new Promise((res) => {
      this.panel.addEventListener("transitionend", () => {
        this.panel.style.height = "auto";
        this.panel.style.transition = "";
        res();
      }, { once: true });
    });
  }

  _collapse() {
    const height = this.panel.scrollHeight + "px";
    this.panel.style.height = height;
    requestAnimationFrame(() => {
      this.panel.style.transition = "height 300ms ease-in-out";
      this.panel.style.height = "0";
    });

    return new Promise((res) => {
      this.panel.addEventListener("transitionend", () => {
        this.panel.style.transition = "";
        res();
      }, { once: true });
    });
  }
}
```
